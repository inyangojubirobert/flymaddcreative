<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>One Dream Initiative - Harnessing Support Through Social Influence | FlyMadd Creative</title>
    
    <!-- Main site styles (consistent with other pages) -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Tailwind CSS for React components -->
    <link rel="stylesheet" href="src/styles/globals.css">
    
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- React and dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10/dist/framer-motion.umd.js"></script>
    
    <!-- Heroicons (for React components) -->
    <script type="module">
        window.HeroIcons = await import('https://cdn.skypack.dev/@heroicons/react/24/outline');
    </script>
    
    <!-- Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Paystack Inline -->
    <script src="https://js.paystack.co/v1/inline.js"></script>

    <!-- Supabase Config & Progress Bar -->
    <script src="./js/supabase-config.js"></script>
    <script src="./js/progress-bar.js"></script>

    <!-- Library Loading Check Script -->
    <script>
        console.log('üöÄ Starting One Dream Initiative...');
        
        // Check library loading status
        function checkLibraries() {
            const checks = {
                React: !!window.React,
                ReactDOM: !!window.ReactDOM,
                Babel: !!window.Babel,
                Supabase: !!window.supabase,
                Paystack: !!window.PaystackPop,
                CSS: typeof CSS !== 'undefined' && CSS.supports,
                Fetch: typeof fetch !== 'undefined'
            };
            
            console.log('üìö Library loading status:', checks);
            
            // Count loaded libraries
            const loadedCount = Object.values(checks).filter(Boolean).length;
            const totalCount = Object.keys(checks).length;
            
            if (loadedCount === totalCount) {
                console.log('‚úÖ All libraries loaded successfully!');
                window.librariesReady = true;
            } else {
                console.warn(`‚ö†Ô∏è ${totalCount - loadedCount} libraries failed to load`);
                window.librariesReady = false;
            }
            
            return checks;
        }
        
        // Check immediately
        window.librariesReady = false;
        
        // Check after a short delay to allow async loading
        setTimeout(() => {
            checkLibraries();
        }, 2000);
    </script>
    
    <style>
        /* One Dream Initiative CSS Variables */
        :root {
            --primary-color: #004AAD;
            --accent-color: #FFD700;
            --background-color: #FFFFFF;
            --text-dark: #1a1a1a;
            --text-light: #666;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow-x: hidden;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow-x: hidden;
        }

        .iframe-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Navigation */
        .navigation {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
            flex-shrink: 0;
            white-space: nowrap;
        }

        .nav-links {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: nowrap;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
        }

        .nav-links::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }

        .nav-link {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.875rem;
            padding: 6px 10px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            color: var(--primary-color);
            background: rgba(0, 74, 173, 0.1);
        }

        .nav-button {
            background: var(--primary-color);
            color: white;
            padding: 10px 18px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        .nav-button:hover {
            background: #003a8a;
            transform: translateY(-1px);
        }

        /* Use the classes from styles.css */
        .hero-section {
            color: white;
            padding: 48px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero-vision {
            font-size: 1.2rem;
            color: var(--accent-color);
            margin-bottom: 1rem;
            font-style: italic;
        }

        .hero-description {
            font-size: 1rem;
            margin-bottom: 1.5rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-button {
            display: inline-block;
            background: var(--accent-color);
            color: var(--primary-color);
            padding: 12px 30px;
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            border-radius: 50px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
        }

        /* Progress Section */
        .progress-section {
            background: white;
            padding: 48px 20px;
            text-align: center;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 16px;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px auto;
            max-width: 500px;
            position: relative;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            max-width: 600px;
            margin: 30px auto 0;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        /* How It Works */
        .how-it-works {
            background: #f8f9fa;
            padding: 50px 20px;
        }

        .section-title {
            text-align: center;
            font-size: 2rem;
            color: var(--text-dark);
            margin-bottom: 2rem;
        }

        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 900px;
            margin: 0 auto;
        }

        .step-card {
            background: white;
            padding: 30px 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .step-card:hover {
            transform: translateY(-3px);
        }

        .step-icon {
            width: 60px;
            height: 60px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 15px;
        }

        .step-title {
            font-size: 1.3rem;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        /* Prizes Section */
        .prizes-section {
            background: var(--primary-color);
            color: white;
            padding: 50px 20px;
            text-align: center;
        }

        .prizes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            max-width: 700px;
            margin: 30px auto 0;
        }

        .prize-card {
            background: rgba(255,255,255,0.1);
            padding: 30px 15px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .prize-card.grand {
            background: linear-gradient(135deg, var(--accent-color), #ffcc00);
            color: var(--primary-color);
            transform: scale(1.05);
        }

        .prize-amount {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        /* Threshold Section */
        .threshold-section {
            background: white;
            padding: 50px 20px;
            text-align: center;
        }

        .threshold-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            border-radius: 15px;
            max-width: 700px;
            margin: 0 auto;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Footer */
        footer {
            background: var(--text-dark);
            color: white;
            padding: 40px 20px 15px;
            margin-top: auto;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }

        .footer-section h3 {
            color: var(--accent-color);
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .footer-section p {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 15px;
            border-top: 1px solid #333;
            color: #ccc;
            font-size: 0.85rem;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .hero-title { font-size: 2rem; }
            .hero-vision { font-size: 1rem; }
            .hero-description { font-size: 0.9rem; }
            .nav-links { 
                display: flex;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                padding: 8px 0;
            }
            .nav-link, .nav-button {
                flex-shrink: 0;
                white-space: nowrap;
            }
            .steps-grid { grid-template-columns: 1fr; gap: 20px; }
            .prizes-grid { grid-template-columns: 1fr; gap: 16px; }
            .stats-grid { grid-template-columns: repeat(3, 1fr); gap: 12px; }
            .stat-card { padding: 12px; }
            .stat-number { font-size: 1.25rem; }
            .section-title { font-size: 1.5rem; }
            .hero-section { padding: 32px 16px; }
            .how-it-works, .prizes-section, .threshold-section { padding: 32px 16px; }
        }

        @media (max-width: 480px) {
            .hero-title { font-size: 1.75rem; }
            .stats-grid { grid-template-columns: 1fr; gap: 10px; }
            .nav-content { padding: 10px 12px; }
            .logo { font-size: 1rem; }
            .nav-button { padding: 8px 14px; font-size: 0.8rem; }
        }

        @media (max-height: 600px) {
            .hero-section { padding: 20px 15px; }
            .how-it-works, .prizes-section, .threshold-section { padding: 25px 15px; }
        }
    </style>
</head>
<body>
    <!-- Browser Compatibility Notification -->
    <div id="browser-compatibility-notice" style="display: none; position: fixed; top: 0; left: 0; right: 0; background: linear-gradient(90deg, #FF6B6B, #4ECDC4); color: white; padding: 10px; text-align: center; z-index: 10000; font-size: 14px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <div style="max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: center; gap: 15px; flex-wrap: wrap;">
            <span style="display: flex; align-items: center; gap: 5px;">
                <span style="font-size: 18px;">‚ö†Ô∏è</span>
                <strong>Browser Compatibility Notice:</strong>
            </span>
            <span id="browser-message">For the best experience, please use a modern browser like Chrome, Firefox, Safari, or Edge.</span>
            <button onclick="this.parentElement.parentElement.style.display='none'" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 5px 10px; border-radius: 15px; cursor: pointer; font-size: 12px; margin-left: auto;">
                Dismiss ‚úï
            </button>
        </div>
    </div>
    <div class="iframe-container">
    <!-- Mobile-optimized Navigation -->
    <nav class="navigation">
        <div class="nav-content">
            <a href="#" class="logo">üåü One Dream Initiative</a>
            <div class="nav-links">
                <a href="#how-it-works" class="nav-link">How It Works</a>
                <a href="#prizes" class="nav-link">Prizes</a>
                <a href="vote.html" class="nav-button">Vote Now</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section onedream-hero-gradient onedream-hero-pattern">
        <div class="hero-content">
            <h1 class="hero-title">One Dream Initiative</h1>
            <p class="hero-vision">Harnessing support through social influence</p>
            <p class="hero-description">
            In partnership with FlyMadd Creative, we‚Äôre building a movement to make your dreams go viral ‚Äî and rewarding. üåü Lean into your social vibe: share a video of yourself expressing your dreams, include your unique registration link, post it on your socials, rally your community to vote, and rise together as we chase our shared vision of success.
            </p>
            <a href="registration.html" class="cta-button">Start Your Journey</a>
        </div>
    </section>

    <!-- Progress Section -->
    <section class="progress-section">
        <div class="container">
            <h2 class="section-title">Community Dream Progress</h2>
            <p style="color: #666; margin-bottom: 20px;">Goal: 1,000,000 total votes from all participants</p>
            
            <!-- Campaign Progress Bar Container -->
            <div id="campaignProgressBar" style="max-width: 600px; margin: 20px auto;">
                <div style="background: #e0e0e0; height: 24px; border-radius: 12px; overflow: hidden; position: relative;">
                    <div id="progressFill" style="background: linear-gradient(90deg, #FFD700, #FFA500); height: 100%; width: 0%; transition: width 1s ease; border-radius: 12px;"></div>
                </div>
            </div>
            
            <p id="progress-text" style="font-size: 1.1rem; margin: 20px 0; color: var(--primary-color);">
                <strong id="progress-percentage">Loading...</strong> ‚Ä¢ <span id="progress-message">Fetching live data from database...</span>
            </p>
            
            <!-- Live Status indicator -->
            <div style="margin: 10px 0; padding: 8px 12px; background: rgba(0,74,173,0.05); border-radius: 6px; font-size: 0.9rem;">
                <span style="color: #666;">Status:</span> 
                <span id="data-status" style="color: var(--primary-color); font-weight: 500;">üîÑ Loading live data...</span>
            </div>
            
            <!-- Horizontal scrollable stats grid for real data -->
            <div class="stats-grid" style="display: flex; overflow-x: auto; gap: 20px; margin-top: 30px; padding-bottom: 10px; scrollbar-width: thin; scrollbar-color: #004AAD #e0e0e0;">
                <div class="stat-card" style="min-width: 160px;">
                    <div class="stat-number" id="stage-emoji">ü•â</div>
                    <div id="stage-name">Bronze Stage</div>
                    <small id="stage-description">Building momentum</small>
                </div>
                <div class="stat-card" style="min-width: 160px;">
                    <div class="stat-number" id="total-participants">--</div>
                    <div>Participants</div>
                    <small>Dream Builders</small>
                </div>
                <div class="stat-card" style="min-width: 160px;">
                    <div class="stat-number" id="total-votes">--</div>
                    <div>Total Votes</div>
                    <small>Community support</small>
                </div>
                <div class="stat-card" style="min-width: 160px;">
                    <div class="stat-number" id="votes-to-goal">--</div>
                    <div>Votes to Goal</div>
                    <small id="next-stage">Keep pushing!</small>
                </div>
            </div>
            <style>
                /* Custom scrollbar for horizontal stats grid */
                .progress-section .stats-grid::-webkit-scrollbar {
                    height: 8px;
                }
                .progress-section .stats-grid::-webkit-scrollbar-thumb {
                    background: #004AAD;
                    border-radius: 4px;
                }
                .progress-section .stats-grid::-webkit-scrollbar-track {
                    background: #e0e0e0;
                    border-radius: 4px;
                }
            </style>
        </div>
    </section>

    <!-- How It Works -->
    <section id="how-it-works" class="how-it-works">
        <div class="container">
            <h2 class="section-title">How It Works</h2>
            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-icon">1</div>
                    <h3 class="step-title">Register</h3>
                    <p>Create your account and get your unique referral link. It takes just 30 seconds to join the movement.</p>
                </div>
                <div class="step-card">
                    <div class="step-icon">2</div>
                    <h3 class="step-title">Share</h3>
                    <p>Share your unique link on your social media posts, with friends, or anyone who supports your dream. Every vote counts!</p>
                </div>
                <div class="step-card">
                    <div class="step-icon">3</div>
                    <h3 class="step-title">Earn Votes</h3>
                    <p>Get votes from visits and contributions. Each vote is valued at $2 toward your total. Climb the leaderboard!</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Prizes Section -->
    <section id="prizes" class="prizes-section">
        <div class="container">
            <h2 class="section-title" style="color: white;">Amazing Prizes Await</h2>
            <p style="font-size: 1.2rem; margin-bottom: 2rem;">When we reach end of game circle, the top winners receive:</p>
            
            <div class="prizes-grid">
                <div class="prize-card grand">
                    <div style="font-size: 4rem; margin-bottom: 20px;">üèÜ</div>
                    <div class="prize-amount">$3,000</div>
                    <h3>Grand Prize</h3>
                    <p>For the participant with the highest total votes</p>
                </div>
                <div class="prize-card">
                    <div style="font-size: 4rem; margin-bottom: 20px;">ü•à</div>
                    <div class="prize-amount">$2000</div>
                    <h3>Second Place</h3>
                    <p>For the runner-up champion</p>
                </div>
                <div class="prize-card">
                    <div style="font-size: 4rem; margin-bottom: 20px;">ü•â</div>
                    <div class="prize-amount">$1000</div>
                    <h3>Third Place</h3>
                    <p>For the bronze medal winner</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Threshold Explanation -->
    <section class="threshold-section">
        <div class="container">
            <div class="threshold-card">
                <h2 style="margin-bottom: 30px;">The One Dream Vote Threshold</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; text-align: left;">
                    <div>
                        <h3 style="color: var(--accent-color); margin-bottom: 15px;">How it works:</h3>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 10px;">‚úì Every supporter matters and helps your dream grow</li>
                            <li style="margin-bottom: 10px;">‚úì Progress through <strong>Bronze ‚Üí Silver ‚Üí Gold ‚Üí Diamond</strong> stages</li>
                            <li style="margin-bottom: 10px;">‚úì Winners are the <strong>most supported dreamers</strong> in each round</li>
                            <li style="margin-bottom: 10px;">‚úì New opportunities unlock with each stage milestone</li>
                        </ul>
                    </div>
                    <div style="text-align: center;">
                        <h3 style="color: #FFD700; margin-bottom: 15px;">Current Round Status</h3>
                        <div id="threshold-stage" style="font-size: 2.5rem; font-weight: 700; color: #FFD700; margin-bottom: 10px;">ü•â Bronze Stage</div>
                        <div id="threshold-progress" style="font-size: 1.8rem; font-weight: 600; color: #FFD700; margin-bottom: 15px;">Loading...</div>
                        <p style="font-size: 1rem; color: #FFD700; line-height: 1.5;">
                            <span id="threshold-message">Loading community progress...</span><br>
                            <strong id="threshold-next">Next milestone loading...</strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <!-- Call to Action -->
    <section style="background: linear-gradient(135deg, var(--accent-color), #ffcc00); padding: 80px 20px; text-align: center;">
        <div class="container">
            <h2 style="color: var(--primary-color); font-size: 2.5rem; margin-bottom: 20px;">Ready to Make Your Dream Reality?</h2>
            <p style="color: var(--primary-color); font-size: 1.2rem; margin-bottom: 40px;">
                Join thousands of participants already sharing their dreams with the world.
            </p>
            <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                <a href="registration.html" style="background: var(--primary-color); color: white; padding: 15px 30px; text-decoration: none; border-radius: 50px; font-weight: 600; transition: all 0.3s ease;">
                    Join the Initiative
                </a>
                <a href="search.html" style="background: #8b5cf6; color: white; padding: 15px 30px; text-decoration: none; border-radius: 50px; font-weight: 600; transition: all 0.3s ease;">
                    üîç Find & Vote
                </a>
                <a href="leadershipBoard.html" style="border: 2px solid var(--primary-color); color: var(--primary-color); padding: 13px 30px; text-decoration: none; border-radius: 50px; font-weight: 600; transition: all 0.3s ease;">
                    View Leaderboard
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>One Dream Initiative</h3>
                    <p>In partnership with FlyMadd Creative, harnessing support through social influence to make dreams reality.</p>
                </div>
         
                <div class="footer-section">
                    <h3>Support</h3>
                    <p><a href="#" style="color: #ccc; text-decoration: none;">Help Center</a></p>
                    <p><a href="#" style="color: #ccc; text-decoration: none;">Contact Us</a></p>
                    <p><a href="#" style="color: #ccc; text-decoration: none;">Terms of Service</a></p>
                </div>
                <div class="footer-section">
                    <h3>FlyMadd Creative</h3>
                
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 One Dream Initiative in partnership with FlyMadd Creative. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Browser Detection & Compatibility Setup
        const BrowserDetector = {
            init() {
                this.detectBrowser();
                this.applyCompatibilityFixes();
                this.setupPerformanceOptimizations();
            },
            
            detectBrowser() {
                const ua = navigator.userAgent;
                const engines = {
                    webkit: /WebKit/.test(ua),
                    blink: /Chrome/.test(ua) && /WebKit/.test(ua),
                    gecko: /Gecko/.test(ua) && !/WebKit/.test(ua),
                    edge: /Edge/.test(ua),
                    safari: /Safari/.test(ua) && !/Chrome/.test(ua),
                    firefox: /Firefox/.test(ua),
                    opera: /Opera|OPR/.test(ua),
                    brave: /Brave/.test(ua),
                    tor: /Tor/.test(ua),
                    mobile: /Mobile|Android|iPhone|iPad/.test(ua),
                    ios: /iPhone|iPad|iPod/.test(ua),
                    android: /Android/.test(ua)
                };
                
                // Store browser info globally
                window.browserInfo = engines;
                
                // Add browser classes to document for CSS targeting
                document.documentElement.className += engines.webkit ? ' webkit' : '';
                document.documentElement.className += engines.blink ? ' blink' : '';
                document.documentElement.className += engines.gecko ? ' gecko' : '';
                document.documentElement.className += engines.safari ? ' safari' : '';
                document.documentElement.className += engines.firefox ? ' firefox' : '';
                document.documentElement.className += engines.mobile ? ' mobile' : '';
                document.documentElement.className += engines.ios ? ' ios' : '';
                
                console.log('üåê Browser detected:', engines);
            },
            
            applyCompatibilityFixes() {
                // IE/Legacy Edge fallbacks
                if (!window.fetch) {
                    console.warn('‚ö†Ô∏è Fetch API not supported, using XMLHttpRequest fallback');
                    this.addFetchPolyfill();
                }
                
                // CSS Grid fallback for older browsers
                if (!CSS.supports('display', 'grid')) {
                    console.warn('‚ö†Ô∏è CSS Grid not supported, applying flexbox fallback');
                    this.addGridFallback();
                }
                
                // Custom Properties fallback
                if (!CSS.supports('color', 'var(--test)')) {
                    console.warn('‚ö†Ô∏è CSS Custom Properties not supported');
                    this.addCustomPropertiesFallback();
                }
            },
            
            setupPerformanceOptimizations() {
                // Reduce animations for privacy browsers or low-end devices
                if (window.browserInfo.tor || navigator.hardwareConcurrency <= 2) {
                    document.documentElement.style.setProperty('--animation-duration', '0.1s');
                    console.log('üîí Reduced animations for privacy/performance');
                }
                
                // Mobile optimizations
                if (window.browserInfo.mobile) {
                    // Prevent zoom on input focus (iOS Safari)
                    if (window.browserInfo.ios) {
                        const inputs = document.querySelectorAll('input, select, textarea');
                        inputs.forEach(input => {
                            if (parseFloat(window.getComputedStyle(input).fontSize) < 16) {
                                input.style.fontSize = '16px';
                            }
                        });
                    }
                    
                    // Add touch-friendly classes
                    document.body.classList.add('touch-device');
                }
                
                // Show compatibility notice for unsupported browsers
                this.checkCompatibilityAndNotify();
            },
            
            checkCompatibilityAndNotify() {
                const notice = document.getElementById('browser-compatibility-notice');
                const messageEl = document.getElementById('browser-message');
                let shouldShow = false;
                let message = '';
                
                // Check for specific browser issues
                if (!window.fetch) {
                    shouldShow = true;
                    message = 'Your browser doesn\'t support modern web features. Please update or switch to Chrome, Firefox, Safari, or Edge.';
                } else if (window.navigator.userAgent.includes('MSIE') || window.navigator.userAgent.includes('Trident')) {
                    shouldShow = true;
                    message = 'Internet Explorer is not supported. Please use Chrome, Firefox, Safari, or Edge for the best experience.';
                } else if (!CSS.supports('display', 'grid')) {
                    shouldShow = true;
                    message = 'Your browser has limited CSS support. Some features may not work properly. Consider updating your browser.';
                } else if (window.browserInfo.tor) {
                    shouldShow = true;
                    message = 'üîí Tor Browser detected. Some features may be limited for privacy. All core functionality will work.';
                    notice.style.background = 'linear-gradient(90deg, #7B68EE, #483D8B)';
                }
                
                if (shouldShow && notice && messageEl) {
                    messageEl.textContent = message;
                    notice.style.display = 'block';
                    
                    // Auto-hide after 10 seconds (except for critical issues)
                    if (!message.includes('Internet Explorer') && !message.includes('doesn\'t support')) {
                        setTimeout(() => {
                            notice.style.display = 'none';
                        }, 10000);
                    }
                }
            },
            
            addFetchPolyfill() {
                // Simple fetch polyfill for IE/old browsers
                if (!window.fetch) {
                    window.fetch = function(url, options = {}) {
                        return new Promise((resolve, reject) => {
                            const xhr = new XMLHttpRequest();
                            xhr.open(options.method || 'GET', url);
                            
                            if (options.headers) {
                                Object.keys(options.headers).forEach(key => {
                                    xhr.setRequestHeader(key, options.headers[key]);
                                });
                            }
                            
                            xhr.onload = () => {
                                resolve({
                                    ok: xhr.status >= 200 && xhr.status < 300,
                                    status: xhr.status,
                                    json: () => Promise.resolve(JSON.parse(xhr.responseText)),
                                    text: () => Promise.resolve(xhr.responseText)
                                });
                            };
                            
                            xhr.onerror = () => reject(new Error('Network error'));
                            xhr.send(options.body);
                        });
                    };
                }
            },
            
            addGridFallback() {
                // Add flexbox fallback styles
                const style = document.createElement('style');
                style.textContent = `
                    .grid-fallback { display: flex; flex-wrap: wrap; }
                    .grid-fallback > * { flex: 1 1 300px; margin: 0.5rem; }
                `;
                document.head.appendChild(style);
                
                // Apply fallback class
                setTimeout(() => {
                    document.querySelectorAll('.grid').forEach(el => {
                        el.classList.add('grid-fallback');
                    });
                }, 100);
            },
            
            addCustomPropertiesFallback() {
                // Define fallback colors for browsers without CSS custom properties
                const style = document.createElement('style');
                style.textContent = `
                    .no-custom-properties {
                        --primary-color: #004AAD;
                        --secondary-color: #FFD700;
                        --text-light: #666;
                    }
                    .no-custom-properties .onedream-progress-fill { background: #FFD700; }
                    .no-custom-properties button { background: #FFD700; color: #004AAD; }
                `;
                document.head.appendChild(style);
                document.documentElement.classList.add('no-custom-properties');
            }
        };
        
        // Initialize browser detection on DOM ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                BrowserDetector.init();
                // Also initialize progress bar early
                setTimeout(() => updateProgress(), 200);
            });
        } else {
            BrowserDetector.init();
            // Initialize progress bar immediately if DOM is already ready
            setTimeout(() => updateProgress(), 100);
        }

        // Add smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Immediate progress bar initialization with mock data
        function initializeProgressBar() {
            const progressImage = document.getElementById('progress-bar-image');
            if (progressImage) {
                // Show mock data immediately
                console.log('üìä Showing mock data until live progress ‚â• 24%');
                applyProgressData(mockData);
                
                // Start periodic checking for live data
                const checkInterval = setInterval(async () => {
                    if (!hasLiveData) {
                        console.log('üîÑ Checking for live data...');
                        await updateProgress();
                        
                        // If we've switched to live data, stop checking
                        if (hasLiveData) {
                            console.log('‚úÖ Switched to live data - stopping periodic checks');
                            clearInterval(checkInterval);
                        }
                    }
                }, 5000); // Check every 5 seconds
                
                console.log('üéØ Progress bar image initialized with mock data (24%)');
            }
        }

        // Try to initialize immediately if elements exist
        if (document.readyState === 'complete') {
            initializeProgressBar();
        }

        // Add dynamic progress animation with intelligent live/mock data detection
        let hasLiveData = false; // Will be set to true when real data is detected
        
        // Mock data for fallback (only used when no live data exists)
        const mockData = {
            progress: 24,
            stage: 'Bronze',
            participants: 1247,
            votes: 12470,
            nextMilestone: 25
        };

        // Function to update progress with automatic live/mock data detection
        async function updateProgress() {
            try {
                // Wait for Supabase to be initialized
                if (!window.supabase) {
                    console.log('‚è≥ Waiting for Supabase initialization...');
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
                
                // Try to fetch live data from Supabase
                if (window.supabase) {
                    console.log('üîç Fetching live data from Supabase...');
                    
                    // Fetch data from existing tables
                    const [participantsResult, votesResult] = await Promise.all([
                        window.supabase.from('participants').select('votes', { count: 'exact' }),
                        window.supabase.from('participants').select('id', { count: 'exact', head: true })
                    ]);
                    
                    console.log('üìä Participants result:', participantsResult);
                    
                    // Calculate total votes from all participants
                    const totalVotes = participantsResult.data?.reduce((sum, p) => sum + (p.votes || 0), 0) || 0;
                    const totalParticipants = participantsResult.count || 0;
                    
                    // Check if we have meaningful live data
                    if (!participantsResult.error && !votesResult.error) {
                        
                        // Calculate progress and stage
                        const campaignGoal = 1000000;
                        const liveProgress = (totalVotes / campaignGoal) * 100;
                        
                        let stage = 'Bronze';
                        let stageDescription = 'Building momentum';
                        if (totalVotes >= 750000) {
                            stage = 'Diamond';
                            stageDescription = 'Elite status achieved!';
                        } else if (totalVotes >= 500000) {
                            stage = 'Gold';
                            stageDescription = 'Excellence in progress';
                        } else if (totalVotes >= 250000) {
                            stage = 'Silver';
                            stageDescription = 'Rising to the top';
                        }
                        
                        const liveData = {
                            progress: liveProgress,
                            stage: stage,
                            stageDescription: stageDescription,
                            participants: totalParticipants,
                            votes: totalVotes,
                            votesToGoal: campaignGoal - totalVotes,
                            nextMilestone: calculateNextMilestone(stage)
                        };
                        
                        console.log(`‚úÖ Live data fetched: ${totalVotes} votes (${liveProgress.toFixed(2)}%)`);
                        
                        // Always use live data when available
                        hasLiveData = true;
                        applyProgressData(liveData);
                        
                        // Update status indicator
                        const statusEl = document.getElementById('data-status');
                        if (statusEl) {
                            statusEl.textContent = `‚úÖ Live data - ${totalVotes.toLocaleString()} total votes`;
                            statusEl.style.color = '#10b981'; // green for live
                        }
                        
                        // Update progress message
                        const progressMessage = document.getElementById('progress-message');
                        if (progressMessage) {
                            progressMessage.textContent = `${totalVotes.toLocaleString()} votes ‚Ä¢ ${(campaignGoal - totalVotes).toLocaleString()} to goal`;
                        }
                        
                        return;
                    } else {
                        console.error('‚ùå Error fetching data:', participantsResult.error || votesResult.error);
                    }
                }
            } catch (error) {
                console.error('‚ö†Ô∏è Could not fetch live data:', error);
                
                // Update status for error state
                const statusEl = document.getElementById('data-status');
                if (statusEl) {
                    statusEl.textContent = `‚ùå Error: ${error.message} - using mock data`;
                    statusEl.style.color = '#ef4444'; // red for error
                }
            }
            
            // Fallback to mock data when no live data is available
            hasLiveData = false;
            applyProgressData(mockData);
            console.log('üìä Using mock data (no live data available):', mockData);
        }

        // Function to calculate next milestone based on current stage
        function calculateNextMilestone(stage) {
            const milestones = {
                'Bronze': 25,
                'Silver': 50, 
                'Gold': 75,
                'Diamond': 100
            };
            return milestones[stage] || 25;
        }

        // Function to apply progress data to UI elements
        function applyProgressData(data) {
            console.log('üéØ Applying progress data:', data);
            
            // Update progress bar fill
            const progressFill = document.getElementById('progressFill');
            const progressPercentage = document.getElementById('progress-percentage');
            const progressMessage = document.getElementById('progress-message');
            const totalParticipants = document.getElementById('total-participants');
            const totalVotesEl = document.getElementById('total-votes');
            const votesToGoal = document.getElementById('votes-to-goal');
            const stageEmoji = document.getElementById('stage-emoji');
            const stageName = document.getElementById('stage-name');
            const stageDescription = document.getElementById('stage-description');
            const nextStage = document.getElementById('next-stage');
            
            // Update progress bar
            if (progressFill) {
                progressFill.style.width = `${Math.min(data.progress, 100).toFixed(1)}%`;
                console.log(`‚úÖ Progress bar updated to ${data.progress.toFixed(1)}%`);
            }
            
            // Update text elements
            if (progressPercentage) {
                progressPercentage.textContent = `${data.progress.toFixed(1)}% Complete`;
            }
            
            if (progressMessage) {
                if (hasLiveData) {
                    progressMessage.textContent = `${data.votes.toLocaleString()} votes ‚Ä¢ ${data.votesToGoal.toLocaleString()} to goal`;
                } else {
                    progressMessage.textContent = 'Join the movement and start your dream journey!';
                }
            }
            
            if (totalParticipants) {
                totalParticipants.textContent = data.participants.toLocaleString();
            }
            
            if (totalVotesEl) {
                totalVotesEl.textContent = data.votes.toLocaleString();
            }
            
            if (votesToGoal) {
                votesToGoal.textContent = data.votesToGoal ? data.votesToGoal.toLocaleString() : '--';
            }
            
            // Update stage info
            const stageInfo = {
                'Bronze': { emoji: 'ü•â', color: '#CD7F32', next: 'Silver Stage at 250K votes' },
                'Silver': { emoji: 'ü•à', color: '#C0C0C0', next: 'Gold Stage at 500K votes' },
                'Gold': { emoji: 'ü•á', color: '#FFD700', next: 'Diamond Stage at 750K votes' },
                'Diamond': { emoji: 'üíé', color: '#4A90E2', next: 'Maximum level achieved!' }
            };
            
            const currentStage = stageInfo[data.stage] || stageInfo.Bronze;
            if (stageEmoji) {
                stageEmoji.textContent = currentStage.emoji;
                console.log(`‚úÖ Stage emoji updated to: ${currentStage.emoji} for ${data.stage} stage`);
            }
            if (stageName) {
                stageName.textContent = `${data.stage} Stage`;
                console.log(`‚úÖ Stage name updated to: ${data.stage} Stage`);
            }
            if (stageDescription) {
                stageDescription.textContent = data.stageDescription || 'Building momentum';
            }
            if (nextStage) {
                nextStage.textContent = currentStage.next;
            }
        }

        window.addEventListener('load', async function() {
            // Initialize Supabase first
            console.log('üöÄ Initializing application...');
            await initializeSupabase();
            
            // Ensure DOM is fully loaded before initializing progress
            setTimeout(() => {
                // Initial progress update with automatic live/mock detection
                updateProgress();
                
                // Set up periodic updates to check for new live data every 30 seconds
                setInterval(() => {
                    updateProgress();
                }, 30000);
            }, 100); // Small delay to ensure all elements are rendered
        });

        // Add counter animation for stats (excluding emoji elements)
        function animateCounters() {
            const statNumbers = document.querySelectorAll('.stat-number');
            statNumbers.forEach(stat => {
                // Skip emoji elements and elements that don't contain numbers
                if (stat.id === 'stage-emoji' || !/\d/.test(stat.textContent)) {
                    return;
                }
                
                const target = parseInt(stat.textContent.replace(/[^0-9]/g, ''));
                
                // Skip if target is NaN or 0
                if (isNaN(target) || target === 0) {
                    return;
                }
                
                let current = 0;
                const increment = target / 50;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    
                    let display = Math.floor(current);
                    if (display >= 1000) {
                        display = Math.floor(display / 1000) + 'K+';
                    }
                    if (stat.textContent.includes('$')) {
                        display = '$' + display;
                    }
                    if (stat.textContent.includes('%')) {
                        display = display + '%';
                    }
                    stat.textContent = display;
                }, 40);
            });
        }

        // Trigger counter animation when section is in view
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    animateCounters();
                    observer.unobserve(entry.target);
                }
            });
        });

        // Find the progress section
        const progressSection = document.querySelector('.progress-section');
        if (progressSection) {
            observer.observe(progressSection);
        }
    </script>

    <!-- React App Components -->
    <script type="text/babel">
        // Enhanced Supabase initialization with browser compatibility
        // üîê Initialize Supabase with public environment variables
        let supabase = null;
        
        // Initialize Supabase directly with environment variables
        async function initializeSupabase() {
            try {
                // Use Next.js public environment variables
                const supabaseUrl = 'https://pjtuisyvpvoswmcgxsfs.supabase.co';
                const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBqdHVpc3l2cHZvc3dtY2d4c2ZzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1Mzg1MDUsImV4cCI6MjA3NzExNDUwNX0.vOYDzWgF1CnhDLtFXmO_aNpPF5jQiCOdtdIhqYRs6IY';
                
                if (window.supabase && window.supabase.createClient) {
                    supabase = window.supabase.createClient(supabaseUrl, supabaseAnonKey, {
                        auth: {
                            autoRefreshToken: true,
                            persistSession: true,
                            detectSessionInUrl: false
                        },
                        db: {
                            schema: 'public'
                        }
                    });
                    
                    // Make it globally available
                    window.supabase = supabase;
                    
                    console.log('‚úÖ Supabase initialized successfully');
                    return true;
                } else {
                    throw new Error('Supabase library not loaded');
                }
            } catch (error) {
                console.error('‚ùå Supabase initialization failed:', error);
                return false;
            }
        }
        
        // Global variables for React components
        let currentUser = null;
        
        // Enhanced utility functions with browser compatibility
        const generateShareableUrl = (username) => {
            return `${window.location.origin}/vote/${username}`;
        };

        const copyToClipboard = async (text) => {
            try {
                // Modern browsers (Chrome, Firefox, Safari, Edge)
                if (navigator.clipboard && window.isSecureContext) {
                    await navigator.clipboard.writeText(text);
                    return true;
                } 
                // Fallback for older browsers or non-HTTPS
                else {
                    const textArea = document.createElement('textarea');
                    textArea.value = text;
                    textArea.style.position = 'fixed';
                    textArea.style.left = '-999999px';
                    textArea.style.top = '-999999px';
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    
                    let successful = false;
                    try {
                        successful = document.execCommand('copy');
                    } catch (err) {
                        console.warn('Copy fallback failed:', err);
                    }
                    
                    document.body.removeChild(textArea);
                    return successful;
                }
            } catch (err) {
                console.error('Copy to clipboard failed:', err);
                return false;
            }
        };
        
        // üí≥ Payment Component with Multiple Options (Flutterwave, Paystack, Crypto, PayPal)
        const PaymentComponent = ({ targetUsername, targetName }) => {
            const [isProcessing, setIsProcessing] = React.useState(false);
            const [selectedMethod, setSelectedMethod] = React.useState('paystack');
            const [amount, setAmount] = React.useState(2.00);

            // Paystack Payment Handler
            const handlePaystackPayment = async () => {
                if (!currentUser) {
                    alert('Please login first to vote!');
                    return;
                }

                setIsProcessing(true);

                try {
                    const paystackOptions = {
                        key: 'pk_test_your_paystack_public_key', // Replace with your actual key
                        email: currentUser.email,
                        amount: amount * 100 * 400, // Convert to kobo (‚Ç¶400 = $1)
                        currency: 'NGN',
                        ref: `ODI_${targetUsername}_${Date.now()}`,
                        
                        customer: {
                            email: currentUser.email,
                            first_name: currentUser.name.split(' ')[0],
                            last_name: currentUser.name.split(' ')[1] || ''
                        },

                        metadata: {
                            username: targetUsername,
                            participant_username: targetUsername,
                            purpose: 'one_dream_initiative_vote',
                            vote_amount: amount,
                            voter_id: currentUser.id
                        },

                        callback: function(response) {
                            console.log('‚úÖ Paystack payment successful:', response);
                            alert(`üéâ Payment successful! Your vote for ${targetName} is being processed.`);
                            setIsProcessing(false);
                            window.location.reload();
                        },

                        onClose: function() {
                            console.log('Payment cancelled');
                            setIsProcessing(false);
                        }
                    };

                    const paystack = new PaystackPop();
                    paystack.setup(paystackOptions);
                    paystack.openIframe();
                } catch (error) {
                    console.error('Payment error:', error);
                    alert('Payment failed. Please try again.');
                    setIsProcessing(false);
                }
            };

            // Test Payment Handler (for development)
            const handleTestPayment = async () => {
                if (!currentUser) {
                    alert('Please login first to vote!');
                    return;
                }

                setIsProcessing(true);

                try {
                    const response = await fetch('https://pjtuisyvpvoswmcgxsfs.supabase.co/functions/v1/test-payment', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${supabase.supabaseKey}`
                        },
                        body: JSON.stringify({
                            username: targetUsername,
                            transaction_id: `test_${Date.now()}`,
                            payment_method: 'test',
                            amount: amount,
                            payer_email: currentUser.email,
                            payer_name: currentUser.name
                        })
                    });

                    const result = await response.json();
                    
                    if (result.success) {
                        alert(`üéâ Test vote successful! ${result.votes_added} votes added for ${result.participant_name}`);
                        window.location.reload();
                    } else {
                        alert(`‚ùå Vote failed: ${result.error}`);
                    }
                } catch (error) {
                    console.error('Test payment error:', error);
                    alert('Test payment failed. Please try again.');
                } finally {
                    setIsProcessing(false);
                }
            };

            return React.createElement('div', {
                className: 'bg-white rounded-xl p-6 shadow-lg border border-gray-200'
            }, [
                React.createElement('h3', {
                    className: 'text-xl font-bold text-gray-800 mb-4',
                    key: 'title'
                }, `üí∞ Vote for ${targetName}`),

                React.createElement('div', {
                    className: 'mb-4',
                    key: 'amount-selector'
                }, [
                    React.createElement('label', {
                        className: 'block text-sm font-medium text-gray-700 mb-2',
                        key: 'label'
                    }, 'Vote Amount (USD)'),
                    React.createElement('select', {
                        value: amount,
                        onChange: (e) => setAmount(parseFloat(e.target.value)),
                        className: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500',
                        key: 'select'
                    }, [
                        React.createElement('option', { value: 2.00, key: '2' }, '$2.00 - 1 Vote'),
                        React.createElement('option', { value: 10.00, key: '10' }, '$10.00 - 5 Votes'),
                        React.createElement('option', { value: 20.00, key: '20' }, '$20.00 - 10 Votes'),
                        React.createElement('option', { value: 50.00, key: '50' }, '$50.00 - 25 Votes')
                    ])
                ]),

                React.createElement('div', {
                    className: 'mb-6',
                    key: 'payment-methods'
                }, [
                    React.createElement('label', {
                        className: 'block text-sm font-medium text-gray-700 mb-3',
                        key: 'label'
                    }, 'Payment Method'),
                    React.createElement('div', {
                        className: 'grid grid-cols-2 gap-3',
                        key: 'methods'
                    }, [
                        React.createElement('button', {
                            onClick: () => setSelectedMethod('paystack'),
                            className: `p-3 border-2 rounded-lg text-center transition-all ${
                                selectedMethod === 'paystack' 
                                    ? 'border-green-500 bg-green-50 text-green-700' 
                                    : 'border-gray-200 hover:border-gray-300'
                            }`,
                            key: 'paystack'
                        }, [
                            React.createElement('div', {
                                className: 'text-lg font-bold',
                                key: 'icon'
                            }, 'üá≥üá¨'),
                            React.createElement('div', {
                                className: 'text-sm font-medium',
                                key: 'text'
                            }, 'Paystack'),
                            React.createElement('div', {
                                className: 'text-xs text-gray-500',
                                key: 'desc'
                            }, 'Cards, Bank Transfer')
                        ]),
                        React.createElement('button', {
                            onClick: () => setSelectedMethod('flutterwave'),
                            className: `p-3 border-2 rounded-lg text-center transition-all ${
                                selectedMethod === 'flutterwave' 
                                    ? 'border-orange-500 bg-orange-50 text-orange-700' 
                                    : 'border-gray-200 hover:border-gray-300'
                            }`,
                            key: 'flutterwave'
                        }, [
                            React.createElement('div', {
                                className: 'text-lg font-bold',
                                key: 'icon'
                            }, 'üí≥'),
                            React.createElement('div', {
                                className: 'text-sm font-medium',
                                key: 'text'
                            }, 'Flutterwave'),
                            React.createElement('div', {
                                className: 'text-xs text-gray-500',
                                key: 'desc'
                            }, 'Credit/Debit Cards')
                        ]),
                        React.createElement('button', {
                            onClick: () => setSelectedMethod('crypto'),
                            className: `p-3 border-2 rounded-lg text-center transition-all ${
                                selectedMethod === 'crypto' 
                                    ? 'border-orange-500 bg-orange-50 text-orange-700' 
                                    : 'border-gray-200 hover:border-gray-300'
                            }`,
                            key: 'crypto'
                        }, [
                            React.createElement('div', {
                                className: 'text-lg font-bold',
                                key: 'icon'
                            }, '‚Çø'),
                            React.createElement('div', {
                                className: 'text-sm font-medium',
                                key: 'text'
                            }, 'Crypto'),
                            React.createElement('div', {
                                className: 'text-xs text-gray-500',
                                key: 'desc'
                            }, 'BTC, ETH, USDC')
                        ]),
                        React.createElement('button', {
                            onClick: () => setSelectedMethod('test'),
                            className: `p-3 border-2 rounded-lg text-center transition-all ${
                                selectedMethod === 'test' 
                                    ? 'border-purple-500 bg-purple-50 text-purple-700' 
                                    : 'border-gray-200 hover:border-gray-300'
                            }`,
                            key: 'test'
                        }, [
                            React.createElement('div', {
                                className: 'text-lg font-bold',
                                key: 'icon'
                            }, 'üß™'),
                            React.createElement('div', {
                                className: 'text-sm font-medium',
                                key: 'text'
                            }, 'Test Mode'),
                            React.createElement('div', {
                                className: 'text-xs text-gray-500',
                                key: 'desc'
                            }, 'Free Testing')
                        ])
                    ])
                ]),

                React.createElement('div', {
                    className: 'space-y-3',
                    key: 'payment-buttons'
                }, [
                    selectedMethod === 'paystack' && React.createElement('button', {
                        onClick: handlePaystackPayment,
                        disabled: isProcessing,
                        className: `w-full py-3 px-4 rounded-lg font-medium transition-all ${
                            isProcessing 
                                ? 'bg-gray-400 cursor-not-allowed' 
                                : 'bg-green-600 hover:bg-green-700 text-white'
                        }`,
                        key: 'paystack-btn'
                    }, isProcessing ? '‚è≥ Processing...' : `üí≥ Pay ‚Ç¶${(amount * 400).toLocaleString()} with Paystack`),

                    selectedMethod === 'flutterwave' && React.createElement('button', {
                        onClick: () => alert('Flutterwave integration coming soon!'),
                        className: 'w-full py-3 px-4 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-all',
                        key: 'flutterwave-btn'
                    }, `üí≥ Pay $${amount} with Flutterwave`),

                    selectedMethod === 'crypto' && React.createElement('button', {
                        onClick: () => alert('Crypto payments coming soon!'),
                        className: 'w-full py-3 px-4 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-all',
                        key: 'crypto-btn'
                    }, `‚Çø Pay $${amount} with Crypto`),

                    selectedMethod === 'test' && React.createElement('button', {
                        onClick: handleTestPayment,
                        disabled: isProcessing,
                        className: `w-full py-3 px-4 rounded-lg font-medium transition-all ${
                            isProcessing 
                                ? 'bg-gray-400 cursor-not-allowed' 
                                : 'bg-purple-600 hover:bg-purple-700 text-white'
                        }`,
                        key: 'test-btn'
                    }, isProcessing ? '‚è≥ Processing...' : `üß™ Test Vote ($${amount})`)
                ]),

                React.createElement('div', {
                    className: 'mt-4 p-3 bg-blue-50 rounded-lg',
                    key: 'info'
                }, [
                    React.createElement('div', {
                        className: 'text-sm text-blue-800',
                        key: 'text'
                    }, `üí° Your vote helps ${targetName} climb the leaderboard! Every $2 = 1 vote.`)
                ])
            ]);
        };

        // Registration Component
        const RegistrationForm = ({ onRegistrationSuccess }) => {
            const [formData, setFormData] = React.useState({
                name: '',
                email: '',
                username: ''
            });
            const [isLoading, setIsLoading] = React.useState(false);
            const [message, setMessage] = React.useState('');

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setMessage('');

                try {
                    // Register participant
                    const { data, error } = await supabase
                        .from('participants')
                        .insert([{
                            name: formData.name,
                            email: formData.email,
                            username: formData.username || null // Let trigger generate if empty
                        }])
                        .select()
                        .single();

                    if (error) {
                        if (error.code === '23505') {
                            setMessage('‚ùå Email or username already exists. Please try different ones.');
                        } else {
                            setMessage(`‚ùå Registration error: ${error.message}`);
                        }
                        return;
                    }

                    setMessage('‚úÖ Registration successful! Loading your dashboard...');
                    setTimeout(() => {
                        onRegistrationSuccess(data);
                    }, 1500);

                } catch (err) {
                    setMessage(`‚ùå Unexpected error: ${err.message}`);
                } finally {
                    setIsLoading(false);
                }
            };

            return React.createElement('div', {
                className: 'bg-white rounded-2xl shadow-xl p-8 max-w-md mx-auto'
            }, [
                React.createElement('div', {
                    className: 'text-center mb-6',
                    key: 'header'
                }, [
                    React.createElement('div', {
                        className: 'text-6xl mb-4',
                        key: 'icon'
                    }, 'üåü'),
                    React.createElement('h2', {
                        className: 'text-2xl font-bold text-gray-800 mb-2',
                        key: 'title'
                    }, 'Join One Dream Initiative'),
                    React.createElement('p', {
                        className: 'text-gray-600',
                        key: 'subtitle'
                    }, 'Start your journey and get your shareable link!')
                ]),
                
                React.createElement('form', {
                    onSubmit: handleSubmit,
                    key: 'form'
                }, [
                    React.createElement('div', {
                        className: 'mb-4',
                        key: 'name-field'
                    }, [
                        React.createElement('label', {
                            className: 'block text-sm font-medium text-gray-700 mb-2',
                            key: 'label'
                        }, 'Full Name *'),
                        React.createElement('input', {
                            type: 'text',
                            required: true,
                            value: formData.name,
                            onChange: (e) => setFormData({...formData, name: e.target.value}),
                            className: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent',
                            placeholder: 'Enter your full name',
                            key: 'input'
                        })
                    ]),
                    
                    React.createElement('div', {
                        className: 'mb-4',
                        key: 'email-field'
                    }, [
                        React.createElement('label', {
                            className: 'block text-sm font-medium text-gray-700 mb-2',
                            key: 'label'
                        }, 'Email Address *'),
                        React.createElement('input', {
                            type: 'email',
                            required: true,
                            value: formData.email,
                            onChange: (e) => setFormData({...formData, email: e.target.value}),
                            className: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent',
                            placeholder: 'Enter your email',
                            key: 'input'
                        })
                    ]),
                    
                    React.createElement('div', {
                        className: 'mb-6',
                        key: 'username-field'
                    }, [
                        React.createElement('label', {
                            className: 'block text-sm font-medium text-gray-700 mb-2',
                            key: 'label'
                        }, 'Username (Optional)'),
                        React.createElement('input', {
                            type: 'text',
                            value: formData.username,
                            onChange: (e) => setFormData({...formData, username: e.target.value}),
                            className: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent',
                            placeholder: 'Leave blank for auto-generation',
                            key: 'input'
                        }),
                        React.createElement('p', {
                            className: 'text-xs text-gray-500 mt-1',
                            key: 'help'
                        }, 'This will be used in your shareable link: /vote/yourusername')
                    ]),
                    
                    React.createElement('button', {
                        type: 'submit',
                        disabled: isLoading,
                        className: `w-full py-3 px-4 rounded-lg font-medium transition-all ${
                            isLoading 
                                ? 'bg-gray-400 cursor-not-allowed' 
                                : 'bg-blue-600 hover:bg-blue-700 text-white'
                        }`,
                        key: 'submit'
                    }, isLoading ? '‚è≥ Registering...' : 'üöÄ Join the Initiative')
                ]),
                
                message && React.createElement('div', {
                    className: `mt-4 p-3 rounded-lg text-center ${
                        message.includes('‚úÖ') ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
                    }`,
                    key: 'message'
                }, message)
            ]);
        };

        // Real-time Leaderboard Component
        const LiveLeaderboard = () => {
            const [participants, setParticipants] = React.useState([]);
            const [globalStats, setGlobalStats] = React.useState(null);
            const [isLoading, setIsLoading] = React.useState(true);
            const [error, setError] = React.useState('');

            const fetchData = async () => {
                try {
                    // Fetch top participants
                    const { data: participantsData, error: participantsError } = await supabase
                        .from('participants')
                        .select('*')
                        .order('total_votes', { ascending: false })
                        .limit(10);

                    if (participantsError) throw participantsError;

                    // Calculate global stats from existing tables
                    const [votesResult, paymentsResult] = await Promise.all([
                        supabase.from('votes').select('id', { count: 'exact', head: true }),
                        supabase.from('payments').select('amount').eq('status', 'completed')
                    ]);

                    const totalVotes = votesResult.count || 0;
                    const totalAmount = paymentsResult.data?.reduce((sum, payment) => sum + (payment.amount || 0), 0) || 0;
                    
                    const statsData = {
                        total_participants: participantsData?.length || 0,
                        total_votes: totalVotes,
                        total_amount: totalAmount,
                        campaign_goal: 1000000,
                        current_stage: totalVotes >= 750000 ? 'Diamond' : totalVotes >= 500000 ? 'Gold' : totalVotes >= 250000 ? 'Silver' : 'Bronze'
                    };

                    setParticipants(participantsData || []);
                    setGlobalStats(statsData);
                    setError('');
                } catch (err) {
                    setError(`Failed to load data: ${err.message}`);
                    console.error('Leaderboard fetch error:', err);
                } finally {
                    setIsLoading(false);
                }
            };

            React.useEffect(() => {
                fetchData();
                
                // Set up real-time subscription
                const subscription = supabase
                    .channel('leaderboard')
                    .on('postgres_changes', 
                        { event: '*', schema: 'public', table: 'participants' },
                        () => fetchData()
                    )
                    .on('postgres_changes',
                        { event: '*', schema: 'public', table: 'votes' },
                        () => fetchData()
                    )
                    .on('postgres_changes',
                        { event: '*', schema: 'public', table: 'payments' },
                        () => fetchData()
                    )
                    .subscribe();

                return () => subscription.unsubscribe();
            }, []);

            if (isLoading) {
                return React.createElement('div', {
                    className: 'bg-white rounded-2xl shadow-xl p-8 animate-pulse'
                }, [
                    React.createElement('div', { className: 'h-8 bg-gray-200 rounded mb-6', key: 'title' }),
                    React.createElement('div', { className: 'h-6 bg-gray-200 rounded mb-8', key: 'subtitle' }),
                    ...Array(5).fill(0).map((_, i) => 
                        React.createElement('div', { className: 'h-16 bg-gray-200 rounded mb-4', key: i })
                    )
                ]);
            }

            if (error) {
                return React.createElement('div', {
                    className: 'bg-white rounded-2xl shadow-xl p-8 text-center'
                }, [
                    React.createElement('div', {
                        className: 'text-6xl mb-4',
                        key: 'icon'
                    }, '‚ö†Ô∏è'),
                    React.createElement('h3', {
                        className: 'text-xl font-bold text-red-600 mb-2',
                        key: 'title'
                    }, 'Connection Error'),
                    React.createElement('p', {
                        className: 'text-gray-600 mb-4',
                        key: 'message'
                    }, error),
                    React.createElement('button', {
                        onClick: () => {
                            setIsLoading(true);
                            fetchData();
                        },
                        className: 'bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700',
                        key: 'retry'
                    }, 'Retry Connection')
                ]);
            }

            const progress = globalStats ? (globalStats.total_votes / globalStats.campaign_goal * 100) : 0;
            const getStageInfo = (stage) => {
                const stages = {
                    'Bronze': { emoji: 'ü•â', color: 'amber' },
                    'Silver': { emoji: 'ü•à', color: 'gray' },
                    'Gold': { emoji: 'ü•á', color: 'yellow' },
                    'Diamond': { emoji: 'üíé', color: 'blue' }
                };
                return stages[stage] || stages.Bronze;
            };

            const stageInfo = getStageInfo(globalStats?.current_stage);

            return React.createElement('div', {
                className: 'bg-white rounded-2xl shadow-xl overflow-hidden'
            }, [
                // Global Progress Section
                React.createElement('div', {
                    className: `bg-gradient-to-r from-${stageInfo.color}-600 to-${stageInfo.color}-800 p-8 text-white`,
                    key: 'progress'
                }, [
                    React.createElement('div', {
                        className: 'flex items-center justify-between mb-4',
                        key: 'header'
                    }, [
                        React.createElement('div', { key: 'left' }, [
                            React.createElement('h2', {
                                className: 'text-3xl font-bold mb-2',
                                key: 'title'
                            }, 'Live Community Progress'),
                            React.createElement('p', {
                                className: 'text-lg opacity-90',
                                key: 'subtitle'
                            }, `${globalStats?.total_participants || 0} dreamers building together`)
                        ]),
                        React.createElement('div', {
                            className: 'text-right',
                            key: 'right'
                        }, [
                            React.createElement('div', {
                                className: 'text-5xl mb-2',
                                key: 'badge'
                            }, stageInfo.emoji),
                            React.createElement('div', {
                                className: 'text-xl font-semibold',
                                key: 'stage'
                            }, `${globalStats?.current_stage || 'Bronze'} Stage`)
                        ])
                    ]),
                    React.createElement('div', {
                        className: 'mb-4',
                        key: 'progress-bar'
                    }, [
                        React.createElement('div', {
                            className: 'flex justify-between items-center mb-2',
                            key: 'progress-header'
                        }, [
                            React.createElement('span', {
                                className: 'text-lg font-medium',
                                key: 'label'
                            }, 'Progress to 1M Votes'),
                            React.createElement('span', {
                                className: 'text-2xl font-bold',
                                key: 'percentage'
                            }, `${(globalStats?.total_votes || 0).toLocaleString()} votes (${progress.toFixed(2)}%)`)
                        ]),
                        React.createElement('div', {
                            className: 'w-full bg-white bg-opacity-20 rounded-full h-4 overflow-hidden',
                            key: 'bar'
                        }, React.createElement('div', {
                            className: 'bg-white h-full rounded-full shadow-lg transition-all duration-1000 ease-out',
                            style: { width: `${Math.min(progress, 100)}%` }
                        }))
                    ]),
                    React.createElement('div', {
                        className: 'text-center text-lg font-medium',
                        key: 'motivational'
                    }, 'üåü Real-time updates from your Supabase database! üåü')
                ]),
                
                // Conditional Leaderboard Section - Only shows when real live data exists
                (participants.length > 0 && globalStats && (globalStats.total_participants > 0 || globalStats.total_votes > 0)) ? 
                    React.createElement('div', {
                        className: 'p-4 md:p-8',
                        key: 'leaderboard'
                    }, [
                        React.createElement('div', {
                            className: 'flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-3',
                            key: 'header'
                        }, [
                            React.createElement('h3', {
                                className: 'text-xl md:text-2xl font-bold text-gray-800',
                                key: 'title'
                            }, `üèÜ Top ${Math.min(participants.length, 10)} Dreamers`),
                            React.createElement('div', {
                                className: 'flex items-center gap-2 text-sm text-gray-600',
                                key: 'live-indicator'
                            }, [
                                React.createElement('div', {
                                    className: 'w-2 h-2 bg-green-500 rounded-full animate-pulse',
                                    key: 'dot'
                                }),
                                React.createElement('span', {
                                    key: 'text'
                                }, 'Live Results')
                            ])
                        ]),
                        
                        React.createElement('div', {
                            className: 'grid gap-3 md:gap-4',
                            key: 'participants'
                        }, participants.slice(0, 10).map((participant, index) => {
                            const isTopThree = index < 3;
                            const rankEmojis = ['ü•á', 'ü•à', 'ü•â'];
                            const stageColors = {
                                'Diamond': 'from-blue-500 to-cyan-400',
                                'Gold': 'from-yellow-500 to-amber-400', 
                                'Silver': 'from-gray-400 to-slate-300',
                                'Bronze': 'from-amber-600 to-orange-500'
                            };
                            
                            return React.createElement('div', {
                                className: `flex items-center p-3 md:p-4 rounded-xl border-2 transition-all hover:shadow-lg ${
                                    isTopThree ? 'bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-300' : 'bg-white border-gray-200'
                                }`,
                                key: participant.id
                            }, [
                                // Rank Badge
                                React.createElement('div', {
                                    className: `flex-shrink-0 w-12 h-12 md:w-14 md:h-14 rounded-full flex items-center justify-center mr-3 md:mr-4 ${
                                        isTopThree ? 'bg-gradient-to-br from-yellow-400 to-amber-500 text-white' : 'bg-gray-100 text-gray-600'
                                    }`,
                                    key: 'rank'
                                }, [
                                    React.createElement('span', {
                                        className: 'text-lg md:text-xl font-bold'
                                    }, index < 3 ? rankEmojis[index] : `#${index + 1}`)
                                ]),
                                
                                // Avatar
                                React.createElement('div', {
                                    className: 'flex-shrink-0 mr-3 md:mr-4',
                                    key: 'avatar'
                                }, React.createElement('div', {
                                    className: `w-10 h-10 md:w-12 md:h-12 rounded-full bg-gradient-to-br ${stageColors[participant.current_stage] || stageColors['Bronze']} flex items-center justify-center text-white font-bold text-sm md:text-lg shadow-lg`
                                }, participant.name.charAt(0).toUpperCase())),
                                
                                // Participant Info
                                React.createElement('div', {
                                    className: 'flex-1 min-w-0',
                                    key: 'info'
                                }, [
                                    React.createElement('div', {
                                        className: 'flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2 mb-1',
                                        key: 'name-row'
                                    }, [
                                        React.createElement('h4', {
                                            className: 'font-semibold text-gray-800 text-sm md:text-base truncate',
                                            key: 'name'
                                        }, participant.name),
                                        React.createElement('span', {
                                            className: `inline-block text-xs px-2 py-1 rounded-full font-medium ${
                                                participant.current_stage === 'Diamond' ? 'bg-blue-100 text-blue-800' :
                                                participant.current_stage === 'Gold' ? 'bg-yellow-100 text-yellow-800' :
                                                participant.current_stage === 'Silver' ? 'bg-gray-100 text-gray-800' :
                                                'bg-amber-100 text-amber-800'
                                            }`,
                                            key: 'stage'
                                        }, `${participant.current_stage} ‚ú®`)
                                    ]),
                                    React.createElement('div', {
                                        className: 'text-xs md:text-sm text-gray-600',
                                        key: 'stats'
                                    }, [
                                        React.createElement('div', {
                                            className: 'font-medium',
                                            key: 'votes'
                                        }, `${participant.total_votes.toLocaleString()} votes ‚Ä¢ $${participant.total_amount.toLocaleString()}`),
                                        React.createElement('div', {
                                            className: 'text-xs opacity-75 truncate',
                                            key: 'username'
                                        }, `@${participant.username}`)
                                    ])
                                ]),
                                
                                // Stage Badge (Mobile)
                                React.createElement('div', {
                                    className: 'flex-shrink-0 ml-2',
                                    key: 'stage-badge'
                                }, React.createElement('div', {
                                    className: 'text-lg md:text-xl'
                                }, participant.current_stage === 'Diamond' ? 'üíé' :
                                   participant.current_stage === 'Gold' ? 'üèÜ' :
                                   participant.current_stage === 'Silver' ? 'ü•à' : 'ü•â'))
                            ]);
                        })),
                        
                        // Show More Button (if more than 10 participants)
                        participants.length > 10 ? React.createElement('div', {
                            className: 'text-center mt-6',
                            key: 'show-more'
                        }, React.createElement('button', {
                            className: 'px-6 py-3 bg-gradient-to-r from-yellow-500 to-amber-500 text-white font-semibold rounded-full hover:from-yellow-600 hover:to-amber-600 transition-all shadow-lg',
                            onClick: () => alert(`${participants.length - 10} more participants! Full leaderboard coming soon...`)
                        }, `View All ${participants.length} Dreamers`)) : null
                    ]) :
                    
                    // Coming Soon Message (when no real registrations/votes yet)
                    React.createElement('div', {
                        className: 'p-6 md:p-8 text-center',
                        key: 'coming-soon'
                    }, [
                        React.createElement('div', {
                            className: 'text-4xl md:text-6xl mb-4',
                            key: 'icon'
                        }, 'üåü'),
                        React.createElement('h4', {
                            className: 'text-lg md:text-xl font-bold text-gray-800 mb-2',
                            key: 'title'
                        }, 'Community Leaderboard Coming Soon!'),
                        React.createElement('p', {
                            className: 'text-sm md:text-base text-gray-600 mb-4 max-w-md mx-auto',
                            key: 'message'
                        }, 'Our live leaderboard will activate once participants start registering and voting. Be the first to join our community of dreamers!'),
                        React.createElement('div', {
                            className: 'flex justify-center',
                            key: 'cta'
                        }, React.createElement('button', {
                            className: 'px-6 py-3 bg-gradient-to-r from-yellow-500 to-amber-500 text-white font-semibold rounded-full hover:from-yellow-600 hover:to-amber-600 transition-all shadow-lg text-sm md:text-base',
                            onClick: () => document.getElementById('get-started')?.scrollIntoView({behavior: 'smooth'})
                        }, 'üöÄ Join the Movement'))
                    ]),
            ]);
        };

        // Simple User Stats Component
        const SimpleUserStats = ({ user }) => {
            if (!user) {
                return React.createElement('div', {
                    className: 'text-center py-12'
                }, [
                    React.createElement('div', {
                        className: 'text-6xl mb-4',
                        key: 'icon'
                    }, 'üîê'),
                    React.createElement('h3', {
                        className: 'text-2xl font-bold text-gray-800 mb-2',
                        key: 'title'
                    }, 'Login Required'),
                    React.createElement('p', {
                        className: 'text-gray-600 mb-6',
                        key: 'description'
                    }, 'Please login to view your personal statistics and share your dream.'),
                    React.createElement('button', {
                        className: 'btn btn-primary',
                        onClick: () => alert('Login feature coming soon!'),
                        key: 'button'
                    }, 'Login Now')
                ]);
            }

            return React.createElement('div', {
                className: 'bg-white rounded-2xl shadow-xl overflow-hidden'
            }, [
                React.createElement('div', {
                    className: 'bg-gradient-to-r from-purple-600 to-blue-600 p-8 text-white',
                    key: 'header'
                }, [
                    React.createElement('h2', {
                        className: 'text-2xl font-bold mb-6',
                        key: 'title'
                    }, `Welcome, ${user.name}!`),
                    React.createElement('div', {
                        className: 'grid grid-cols-1 md:grid-cols-3 gap-6',
                        key: 'stats'
                    }, [
                        React.createElement('div', {
                            className: 'bg-white bg-opacity-20 rounded-xl p-4 text-center',
                            key: 'progress'
                        }, [
                            React.createElement('div', {
                                className: 'text-3xl font-bold mb-1',
                                key: 'number'
                            }, '3.2%'),
                            React.createElement('div', {
                                className: 'text-sm opacity-90',
                                key: 'label'
                            }, 'Personal Growth'),
                            React.createElement('div', {
                                className: 'text-xs opacity-75 mt-1',
                                key: 'message'
                            }, 'Amazing progress!')
                        ]),
                        React.createElement('div', {
                            className: 'bg-white bg-opacity-20 rounded-xl p-4 text-center',
                            key: 'level'
                        }, [
                            React.createElement('div', {
                                className: 'text-2xl mb-1',
                                key: 'badge'
                            }, 'üå±'),
                            React.createElement('div', {
                                className: 'font-semibold',
                                key: 'name'
                            }, 'Seedling'),
                            React.createElement('div', {
                                className: 'text-xs opacity-75 mt-1',
                                key: 'level'
                            }, 'Level 1')
                        ]),
                        React.createElement('div', {
                            className: 'bg-white bg-opacity-20 rounded-xl p-4 text-center',
                            key: 'supporters'
                        }, [
                            React.createElement('div', {
                                className: 'text-2xl font-bold mb-1',
                                key: 'number'
                            }, '47'),
                            React.createElement('div', {
                                className: 'text-sm opacity-90',
                                key: 'label'
                            }, 'Dream Supporters'),
                            React.createElement('div', {
                                className: 'text-xs opacity-75 mt-1',
                                key: 'message'
                            }, 'Every one counts!')
                        ])
                    ])
                ])
            ]);
        };

        // Main App Component
        const OneDreamApp = () => {
            const [activeView, setActiveView] = React.useState('leaderboard');
            const [currentUser, setCurrentUser] = React.useState(null);
            const [showRegistration, setShowRegistration] = React.useState(false);

            const handleRegistrationSuccess = (userData) => {
                setCurrentUser(userData);
                setShowRegistration(false);
                setActiveView('dashboard');
            };

            const handleLogin = () => {
                setShowRegistration(true);
            };

            const handleLogout = () => {
                setCurrentUser(null);
                setActiveView('leaderboard');
                setShowRegistration(false);
            };

            // Show registration form when requested
            if (showRegistration && !currentUser) {
                return React.createElement('div', {
                    className: 'min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 py-12'
                }, [
                    React.createElement('div', {
                        className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8',
                        key: 'container'
                    }, [
                        React.createElement('div', {
                            className: 'text-center mb-8',
                            key: 'header'
                        }, [
                            React.createElement('button', {
                                onClick: () => setShowRegistration(false),
                                className: 'mb-4 text-blue-600 hover:text-blue-800 transition-colors',
                                key: 'back'
                            }, '‚Üê Back to Leaderboard'),
                            React.createElement('h1', {
                                className: 'text-4xl font-bold text-gray-900 mb-4',
                                key: 'title'
                            }, 'Join the One Dream Initiative'),
                            React.createElement('p', {
                                className: 'text-xl text-gray-600',
                                key: 'subtitle'
                            }, 'Register now to get your shareable link and start your journey!')
                        ]),
                        React.createElement(RegistrationForm, {
                            onRegistrationSuccess: handleRegistrationSuccess,
                            key: 'registration'
                        })
                    ])
                ]);
            }

            return React.createElement('div', {
                className: 'min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50'
            }, [
                // Header
                React.createElement('header', {
                    className: 'bg-white shadow-sm border-b border-gray-200',
                    key: 'header'
                }, React.createElement('div', {
                    className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8'
                }, React.createElement('div', {
                    className: 'flex justify-between items-center h-16'
                }, [
                    React.createElement('div', {
                        className: 'flex items-center gap-4',
                        key: 'left'
                    }, [
                        React.createElement('h1', {
                            className: 'text-2xl font-bold gradient-text',
                            key: 'title'
                        }, 'One Dream Initiative'),
                        React.createElement('div', {
                            className: 'hidden sm:flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium',
                            key: 'badge'
                        }, [
                            React.createElement('span', { key: 'icon' }, 'üéØ'),
                            React.createElement('span', { key: 'text' }, 'Live Testing Mode')
                        ])
                    ]),
                    React.createElement('div', {
                        className: 'flex items-center gap-4',
                        key: 'right'
                    }, [
                        // View switcher
                        React.createElement('div', {
                            className: 'flex bg-gray-100 rounded-lg p-1',
                            key: 'switcher'
                        }, [
                            React.createElement('button', {
                                onClick: () => setActiveView('leaderboard'),
                                className: `px-4 py-2 rounded-md text-sm font-medium transition-all ${
                                    activeView === 'leaderboard'
                                        ? 'bg-white shadow-md text-blue-600'
                                        : 'text-gray-600 hover:text-gray-800'
                                }`,
                                key: 'leaderboard'
                            }, 'üèÜ Leaderboard'),
                            currentUser && React.createElement('button', {
                                onClick: () => setActiveView('dashboard'),
                                className: `px-4 py-2 rounded-md text-sm font-medium transition-all ${
                                    activeView === 'dashboard'
                                        ? 'bg-white shadow-md text-blue-600'
                                        : 'text-gray-600 hover:text-gray-800'
                                }`,
                                key: 'dashboard'
                            }, 'üìä My Dashboard')
                        ]),
                        // User menu
                        currentUser ? React.createElement('div', {
                            className: 'flex items-center gap-3',
                            key: 'user-menu'
                        }, [
                            React.createElement('div', {
                                className: 'text-sm',
                                key: 'greeting'
                            }, React.createElement('div', {
                                className: 'font-medium text-gray-900'
                            }, `Hello, ${currentUser.name.split(' ')[0]}! üëã`)),
                            React.createElement('button', {
                                onClick: handleLogout,
                                className: 'bg-red-100 text-red-800 px-3 py-1 rounded-lg text-sm hover:bg-red-200 transition-all',
                                key: 'logout'
                            }, 'Logout')
                        ]) : React.createElement('button', {
                            onClick: handleLogin,
                            className: 'bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-all',
                            key: 'login'
                        }, 'üöÄ Join Initiative')
                    ])
                ]))),

                // Main Content
                React.createElement('main', {
                    className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8',
                    key: 'main'
                }, 
                    activeView === 'leaderboard' ? 
                        React.createElement('div', {
                            className: 'space-y-8'
                        }, [
                            React.createElement('div', {
                                className: 'text-center',
                                key: 'header'
                            }, [
                                React.createElement('h2', {
                                    className: 'text-3xl font-bold text-gray-900 mb-2',
                                    key: 'title'
                                }, 'üåü Live Dream Leaderboard üåü'),
                                React.createElement('p', {
                                    className: 'text-lg text-gray-600',
                                    key: 'subtitle'
                                }, 'Real-time data from your Supabase database!')
                            ]),
                            React.createElement(LiveLeaderboard, { key: 'leaderboard' })
                        ]) :
                        activeView === 'dashboard' && currentUser ?
                            React.createElement('div', {
                                className: 'space-y-8'
                            }, [
                                React.createElement(UserDashboard, { 
                                    user: currentUser,
                                    onLogout: handleLogout,
                                    key: 'dashboard' 
                                })
                            ]) :
                            React.createElement('div', {
                                className: 'text-center py-12'
                            }, [
                                React.createElement('div', {
                                    className: 'text-6xl mb-4',
                                    key: 'icon'
                                }, 'üîê'),
                                React.createElement('h3', {
                                    className: 'text-2xl font-bold text-gray-800 mb-2',
                                    key: 'title'
                                }, 'Please Register First'),
                                React.createElement('p', {
                                    className: 'text-gray-600 mb-6',
                                    key: 'description'
                                }, 'Join the initiative to access your personal dashboard.'),
                                React.createElement('button', {
                                    onClick: handleLogin,
                                    className: 'bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all',
                                    key: 'register'
                                }, 'üöÄ Register Now')
                            ])
                )
            ]);
        };

        // Initialize the app (compatible with React 18)
        const renderApp = () => {
            console.log('üéØ Attempting to render React app...');
            
            // Check if container exists
            const container = document.getElementById('onedream-app-root');
            if (!container) {
                console.error('‚ùå Container #onedream-app-root not found');
                return;
            }
            
            // Check if libraries are loaded
            if (!window.React) {
                console.error('‚ùå React not loaded');
                showErrorMessage(container, 'React library failed to load');
                return;
            }
            
            if (!window.ReactDOM) {
                console.error('‚ùå ReactDOM not loaded');
                showErrorMessage(container, 'ReactDOM library failed to load');
                return;
            }
            
            try {
                console.log('üîÑ Creating React app...');
                
                // Try React 18 createRoot method first
                if (ReactDOM.createRoot) {
                    console.log('Using React 18 createRoot method');
                    const root = ReactDOM.createRoot(container);
                    root.render(React.createElement(OneDreamApp));
                    console.log('‚úÖ React app rendered using createRoot (React 18)');
                } 
                // Fallback to legacy render method
                else if (ReactDOM.render) {
                    console.log('Using legacy ReactDOM.render method');
                    ReactDOM.render(
                        React.createElement(OneDreamApp), 
                        container
                    );
                    console.log('‚úÖ React app rendered using legacy render method');
                }
                else {
                    throw new Error('No ReactDOM render method available');
                }
            } catch (error) {
                console.error('‚ùå Failed to render React app:', error);
                showErrorMessage(container, error.message);
            }
        };

        function showErrorMessage(container, errorMsg) {
            container.innerHTML = `
                <div style="text-align: center; padding: 40px; background: white; border-radius: 20px; margin: 20px; border: 2px solid #fecaca;">
                    <div style="font-size: 3rem; margin-bottom: 20px;">‚ö†Ô∏è</div>
                    <h3 style="color: #dc2626; margin-bottom: 15px;">React App Failed to Load</h3>
                    <p style="color: #666; margin-bottom: 10px;">The interactive features are temporarily unavailable.</p>
                    <details style="margin: 20px 0; text-align: left;">
                        <summary style="cursor: pointer; color: #3b82f6; margin-bottom: 10px;">Technical Details</summary>
                        <pre style="background: #f3f4f6; padding: 15px; border-radius: 5px; font-size: 0.8rem; overflow-x: auto;">${errorMsg}</pre>
                    </details>
                    <div style="margin-top: 20px;">
                        <button onclick="location.reload()" style="background: #3b82f6; color: white; padding: 10px 20px; border: none; border-radius: 5px; margin-right: 10px; cursor: pointer;">
                            üîÑ Retry Loading
                        </button>
                        <button onclick="window.open('test-debug.html', '_blank')" style="background: #6b7280; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
                            üîß Debug Mode
                        </button>
                    </div>
                </div>
            `;
        }

        // Enhanced initialization with multiple retry attempts
        let renderAttempts = 0;
        const maxAttempts = 3;

        function attemptRender() {
            renderAttempts++;
            console.log(`üîÑ Render attempt ${renderAttempts}/${maxAttempts}`);
            
            if (window.librariesReady || renderAttempts >= maxAttempts) {
                renderApp();
            } else {
                console.log('‚è≥ Waiting for libraries to load...');
                setTimeout(attemptRender, 1000);
            }
        }

        // Start rendering when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', async () => {
                await initializeSupabase();
                setTimeout(attemptRender, 500);
            });
        } else {
            initializeSupabase().then(() => {
                setTimeout(attemptRender, 500);
            });
        }

        // Also try after full page load
        window.addEventListener('load', () => {
            if (renderAttempts === 0) {
                setTimeout(attemptRender, 1000);
            }
        });

        // ========================================
        // LIVE DATA LOADING FOR PROGRESS & STATS
        // ========================================
        const GOAL_VOTES = 1000000;

        async function loadLiveStats() {
            console.log('üìä Loading live stats for One Dream Initiative...');
            
            try {
                if (!window.SupabaseAPI) {
                    console.warn('‚ö†Ô∏è SupabaseAPI not loaded, will retry...');
                    setTimeout(loadLiveStats, 1000);
                    return;
                }

                // Fetch leaderboard data to calculate totals
                const participants = await window.SupabaseAPI.getLeaderboard(100);
                
                if (!participants || participants.length === 0) {
                    updateStatsDisplay(0, 0);
                    return;
                }

                // Calculate totals
                const totalVotes = participants.reduce((sum, p) => sum + (p.total_votes || 0), 0);
                const totalParticipants = participants.length;
                
                // Update the display
                updateStatsDisplay(totalVotes, totalParticipants);
                
                console.log('‚úÖ Live stats loaded:', { totalVotes, totalParticipants });
                
            } catch (error) {
                console.error('‚ùå Error loading live stats:', error);
                document.getElementById('data-status').textContent = '‚ö†Ô∏è Error loading - using cached data';
            }
        }

        function updateStatsDisplay(totalVotes, totalParticipants) {
            const progressPercent = ((totalVotes / GOAL_VOTES) * 100);
            const votesToGoal = Math.max(0, GOAL_VOTES - totalVotes);
            const stage = getCommunityStage(progressPercent);
            
            // Update progress bar
            const progressFill = document.getElementById('progressFill');
            if (progressFill) {
                progressFill.style.width = Math.min(progressPercent, 100) + '%';
            }
            
            // Update progress text
            const progressPercentage = document.getElementById('progress-percentage');
            if (progressPercentage) {
                progressPercentage.textContent = progressPercent.toFixed(2) + '% Complete';
            }
            
            const progressMessage = document.getElementById('progress-message');
            if (progressMessage) {
                progressMessage.textContent = getProgressMessage(progressPercent);
            }
            
            // Update status
            const dataStatus = document.getElementById('data-status');
            if (dataStatus) {
                dataStatus.innerHTML = '‚úÖ <span style="color: #22c55e;">Live data connected</span> ‚Ä¢ Updated just now';
            }
            
            // Update stats cards
            const stageEmoji = document.getElementById('stage-emoji');
            if (stageEmoji) stageEmoji.textContent = stage.icon;
            
            const stageName = document.getElementById('stage-name');
            if (stageName) stageName.textContent = stage.name + ' Stage';
            
            const stageDesc = document.getElementById('stage-description');
            if (stageDesc) stageDesc.textContent = stage.description;
            
            const totalParticipantsEl = document.getElementById('total-participants');
            if (totalParticipantsEl) totalParticipantsEl.textContent = totalParticipants.toLocaleString();
            
            const totalVotesEl = document.getElementById('total-votes');
            if (totalVotesEl) totalVotesEl.textContent = totalVotes.toLocaleString();
            
            const votesToGoalEl = document.getElementById('votes-to-goal');
            if (votesToGoalEl) votesToGoalEl.textContent = formatNumber(votesToGoal);
            
            const nextStage = document.getElementById('next-stage');
            if (nextStage) nextStage.textContent = getNextMilestoneText(progressPercent);
            
            // Update threshold section
            const thresholdStage = document.getElementById('threshold-stage');
            if (thresholdStage) thresholdStage.textContent = stage.icon + ' ' + stage.name + ' Stage';
            
            const thresholdProgress = document.getElementById('threshold-progress');
            if (thresholdProgress) thresholdProgress.textContent = progressPercent.toFixed(1) + '% Progress';
            
            const thresholdMessage = document.getElementById('threshold-message');
            if (thresholdMessage) thresholdMessage.textContent = getProgressMessage(progressPercent);
            
            const thresholdNext = document.getElementById('threshold-next');
            if (thresholdNext) thresholdNext.textContent = getNextMilestoneText(progressPercent);
            
            // Also render progress bar using OneDreamProgress if available
            if (window.OneDreamProgress) {
                window.OneDreamProgress.renderCampaignProgress('campaignProgressBar', totalVotes);
            }
        }

        function getCommunityStage(percent) {
            if (percent >= 50) return { name: 'Diamond', icon: 'üëë', description: 'Community champions!' };
            if (percent >= 25) return { name: 'Platinum', icon: 'üíé', description: 'Elite supporters!' };
            if (percent >= 10) return { name: 'Gold', icon: 'ü•á', description: 'Strong momentum!' };
            if (percent >= 5) return { name: 'Silver', icon: 'ü•à', description: 'Growing fast!' };
            return { name: 'Bronze', icon: 'ü•â', description: 'Building momentum' };
        }

        function getProgressMessage(percent) {
            if (percent >= 50) return 'The community is blazing ahead! Dreams are becoming reality!';
            if (percent >= 25) return 'Amazing progress! The community is on fire!';
            if (percent >= 10) return 'Great momentum! Keep sharing your dreams!';
            if (percent >= 5) return 'Growing steadily! Every vote counts!';
            if (percent >= 1) return 'The journey has begun! Keep pushing forward!';
            return 'Join the movement and start your dream journey!';
        }

        function getNextMilestoneText(percent) {
            if (percent >= 50) return '100% goal: Final milestone!';
            if (percent >= 25) return 'Diamond Stage at 50%!';
            if (percent >= 10) return 'Platinum Stage at 25%!';
            if (percent >= 5) return 'Gold Stage at 10%!';
            return 'Silver Stage at 5%!';
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(0) + 'K';
            return num.toLocaleString();
        }

        // Load stats when page loads
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(loadLiveStats, 1500);
        });
        
        // Also try on window load
        window.addEventListener('load', () => {
            setTimeout(loadLiveStats, 2000);
        });
    </script>
    </div> <!-- Close iframe-container -->
</body>
</html>